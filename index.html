<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestión de Servicios</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center justify-content-center" href="#" style="height: 100%;">
                <img src="assets/logoconsegur2.png" alt="Consegur S.A.S." height="80" class="d-inline-block">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" id="nav-login" href="#" onclick="showLogin()">Iniciar Sesión</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-none" id="nav-admin-dashboard" href="#" onclick="showAdminDashboard()">Administrador</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-none" id="nav-employee-dashboard" href="#" onclick="showEmployeeDashboard()">Técnico</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-none" id="nav-logout" href="#" onclick="logout()">Cerrar Sesión</a>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-outline-light btn-sm" id="theme-toggle" onclick="toggleTheme()" title="Cambiar tema">
                            <i class="bi bi-sun-fill" id="theme-icon"></i>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">

        <section id="login-section" class="d-block">
            <div class="card mx-auto" style="max-width: 400px;">
                <div class="card-header text-center">
                    <h4>Iniciar Sesión</h4>
                </div>
                <div class="card-body">
                    <form id="login-form">
                        <div class="mb-3">
                            <label for="username" class="form-label">Usuario</label>
                            <input type="text" class="form-control" id="username" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Contraseña</label>
                            <input type="password" class="form-control" id="password" autocomplete="current-password" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Ingresar</button>
                        <p id="login-error" class="text-danger mt-2"></p>
                    </form>
                </div>
            </div>
        </section>

        <section id="admin-dashboard-section" class="d-none">
            <h2 class="mb-4">Administrador</h2>

            <ul class="nav nav-tabs" id="adminTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="users-tab" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab" aria-controls="users" aria-selected="true">Usuarios</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="clients-tab" data-bs-toggle="tab" data-bs-target="#clients" type="button" role="tab" aria-controls="clients" aria-selected="false">Clientes</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="services-tab" data-bs-toggle="tab" data-bs-target="#services" type="button" role="tab" aria-controls="services" aria-selected="false">Servicios</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="costo-servicios-tab" data-bs-toggle="tab" data-bs-target="#costo-servicios" type="button" role="tab" aria-controls="costo-servicios" aria-selected="false">Costo Servicios</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="remisiones-tab" data-bs-toggle="tab" data-bs-target="#remisiones" type="button" role="tab" aria-controls="remisiones" aria-selected="false">Remisiones</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="assign-tab" data-bs-toggle="tab" data-bs-target="#assign" type="button" role="tab" aria-controls="assign" aria-selected="false">Asignar Servicios</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="reports-tab" data-bs-toggle="tab" data-bs-target="#reports" type="button" role="tab" aria-controls="reports" aria-selected="false">
                        <span id="admin-reports-tab">Reportes/Novedades</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="admin-notifications-tab-button" data-bs-toggle="tab" data-bs-target="#admin-notifications" type="button" role="tab" aria-controls="admin-notifications" aria-selected="false">
                        <span id="admin-notifications-tab">Notificaciones</span>
                    </button>
                </li>
            </ul>

            <div class="tab-content mt-3" id="adminTabsContent">
                <div class="tab-pane fade show active" id="users" role="tabpanel" aria-labelledby="users-tab">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-people-fill me-2" style="font-size: 1.2rem;"></i>
                                <span>Gestión de Usuarios</span>
                            </div>
                            <div>
                                <button class="btn btn-danger btn-sm me-2" onclick="openDeleteUsersModal()">
                                    ELIMINAR
                                </button>
                                <button class="btn btn-success btn-sm me-2" onclick="exportUsersToExcel()">
                                    EXPORTAR
                                </button>
                                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#createUserModal">
                                    CREAR USUARIO
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="search-users" class="form-label fw-bold">BUSCAR:</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="search-users" onkeyup="filterUsers()" placeholder="Buscar por ID, usuario, rol o fecha de creación...">
                                    <button class="btn btn-outline-secondary" type="button" onclick="clearUserSearch()" title="Limpiar búsqueda">
                                        <i class="bi bi-x-circle"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>ID</th>
                                            <th>USUARIO</th>
                                            <th>ROL</th>
                                            <th>FECHA DE CREACIÓN</th>
                                            <th>ACCIONES</th>
                                        </tr>
                                    </thead>
                                    <tbody id="user-list">
                                        </tbody>
                                </table>
                            </div>
                            
                            <!-- Vista móvil de tarjetas para usuarios admin -->
                            <div class="mobile-services-view" id="user-list-cards">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="clients" role="tabpanel" aria-labelledby="clients-tab">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-people-fill me-2" style="font-size: 1.2rem;"></i>
                                <span>Gestión de Clientes</span>
                            </div>
                            <div>
                                <button class="btn btn-danger btn-sm me-2" onclick="openDeleteClientsModal()">
                                    ELIMINAR
                                </button>
                                <button class="btn btn-success btn-sm me-2" onclick="exportClientsToExcel()">
                                    EXPORTAR
                                </button>
                                <button class="btn btn-warning btn-sm me-2" onclick="importClientsFromExcel()">
                                    IMPORTAR
                                </button>
                                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#createClientModal">
                                    CREAR CLIENTE
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="search-clients" class="form-label fw-bold">BUSCAR:</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="search-clients" onkeyup="filterClients()" placeholder="Buscar por nombre, NIT/CC, dirección, teléfono, email o fecha de creación...">
                                    <button class="btn btn-outline-secondary" type="button" onclick="clearClientSearch()" title="Limpiar búsqueda">
                                        <i class="bi bi-x-circle"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>NOMBRE</th>
                                            <th>NIT/CC</th>
                                            <th>DIRECCIÓN</th>
                                            <th>TELÉFONO</th>
                                            <th>EMAIL</th>
                                            <th>CONSECUTIVO</th>
                                            <th>FECHA DE CREACIÓN</th>
                                            <th>ACCIONES</th>
                                        </tr>
                                    </thead>
                                    <tbody id="client-list">
                                        </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="services" role="tabpanel" aria-labelledby="services-tab">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-tools me-2" style="font-size: 1.2rem;"></i>
                                <span>Servicios Registrados</span>
                            </div>
                            <div>
                                <button class="btn btn-danger btn-sm me-2" onclick="openDeleteServicesModal()">
                                    ELIMINAR
                                </button>
                                <button class="btn btn-success btn-sm me-2" onclick="exportServicesToExcel()">
                                    EXPORTAR
                                </button>
                                <button class="btn btn-warning btn-sm me-2" onclick="importServicesFromExcel()">
                                    IMPORTAR
                                </button>
                                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#registerServiceModal">
                                    REGISTRAR SERVICIO
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-3">
                                    <label for="filter-date-from" class="form-label">Fecha Desde:</label>
                                    <input type="date" class="form-control" id="filter-date-from" onchange="filterServices()">
                                </div>
                                <div class="col-md-3">
                                    <label for="filter-date-to" class="form-label">Fecha Hasta:</label>
                                    <input type="date" class="form-control" id="filter-date-to" onchange="filterServices()">
                                </div>
                                <div class="col-md-6">
                                    <label for="search-services" class="form-label">Buscar:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="search-services" onkeyup="filterServices()" placeholder="Buscar por ID, cliente, tipo servicio, descripción, técnico o estado...">
                                        <button class="btn btn-outline-secondary" type="button" onclick="clearFilters()" title="Limpiar filtros">
                                            <i class="bi bi-x-circle"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-4">
                                <div class="row g-3 justify-content-center">
                                    <div class="col-md-2">
                                        <div class="stats-card bg-primary" style="cursor: pointer;" onclick="filterServicesByStatus('todos')" title="Ver todos los servicios">
                                            <div class="card-title">Total Servicios</div>
                                            <div class="card-number" id="total-services-count">0</div>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="stats-card bg-success" style="cursor: pointer;" onclick="filterServicesByStatus('Finalizado')" title="Filtrar por servicios finalizados">
                                            <div class="card-title">Finalizados</div>
                                            <div class="card-number" id="completed-services-count">0</div>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="stats-card bg-warning" style="cursor: pointer;" onclick="filterServicesByStatus('En proceso')" title="Filtrar por servicios en proceso">
                                            <div class="card-title">En Proceso</div>
                                            <div class="card-number" id="in-progress-services-count">0</div>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="stats-card bg-info" style="cursor: pointer;" onclick="filterServicesByStatus('Pendiente')" title="Filtrar por servicios pendientes">
                                            <div class="card-title">Pendientes</div>
                                            <div class="card-number" id="pending-services-count">0</div>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="stats-card bg-danger" style="cursor: pointer;" onclick="filterServicesByStatus('Cancelado')" title="Filtrar por servicios cancelados">
                                            <div class="card-title">Cancelados</div>
                                            <div class="card-number" id="cancelled-services-count">0</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>FECHA</th>
                                            <th>HORA</th>
                                            <th>CLIENTE</th>
                                            <th>NIT/CC</th>
                                            <th>UBICACIÓN</th>
                                            <th>CÓDIGO SERVICIO</th>
                                            <th>TÉCNICO</th>
                                            <th>ESTADO</th>
                                            <th>ACCIONES</th>
                                        </tr>
                                    </thead>
                                    <tbody id="services-list-admin">
                                        </tbody>
                                </table>
                            </div>
                            
                            <!-- Vista móvil de tarjetas para servicios admin -->
                            <div class="mobile-services-view" id="services-list-admin-cards">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="costo-servicios" role="tabpanel" aria-labelledby="costo-servicios-tab">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-currency-dollar me-2" style="font-size: 1.5rem;"></i>
                                <span>Gestión de Costos de Servicios</span>
                            </div>
                            <div>
                                <button class="btn btn-danger btn-sm me-2" onclick="openDeleteCostoServiciosModal()">
                                    ELIMINAR
                                </button>
                                <button class="btn btn-success btn-sm me-2" onclick="exportCostoServiciosToExcel()">
                                    EXPORTAR
                                </button>
                                <button class="btn btn-warning btn-sm me-2" onclick="importCostoServiciosFromExcel()">
                                    IMPORTAR
                                </button>
                                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#createCostoServicioModal">
                                    CREAR SERVICIO
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-3">
                                    <label for="filter-costo-servicio-date-from" class="form-label fw-bold">FECHA DESDE:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control date-picker-input" id="filter-costo-servicio-date-from" placeholder="dd/mm/aaaa" onchange="filterCostoServicios()">
                                        <span class="input-group-text date-picker-icon" style="cursor: pointer;"><i class="bi bi-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="filter-costo-servicio-date-to" class="form-label fw-bold">FECHA HASTA:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control date-picker-input" id="filter-costo-servicio-date-to" placeholder="dd/mm/aaaa" onchange="filterCostoServicios()">
                                        <span class="input-group-text date-picker-icon" style="cursor: pointer;"><i class="bi bi-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="search-costo-servicios" class="form-label fw-bold">BUSCAR:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="search-costo-servicios" onkeyup="filterCostoServicios()" placeholder="Buscar por código, tipo de servicio, descripción o precio...">
                                        <button class="btn btn-outline-secondary" type="button" onclick="clearCostoServiciosFilters()" title="Limpiar filtros">
                                            <i class="bi bi-x"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>CÓDIGO SERVICIO</th>
                                            <th>FECHA</th>
                                            <th>TIPO DE SERVICIO</th>
                                            <th>DESCRIPCIÓN</th>
                                            <th>PRECIO</th>
                                            <th>ACCIONES</th>
                                        </tr>
                                    </thead>
                                    <tbody id="costo-servicios-list">
                                        </tbody>
                                </table>
                            </div>
                            <div id="costo-servicios-pagination"></div>
                            
                            <!-- Vista móvil de tarjetas para costo servicios -->
                            <div class="mobile-services-view" id="costo-servicios-cards">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="remisiones" role="tabpanel" aria-labelledby="remisiones-tab">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-file-earmark-text me-2" style="font-size: 1.2rem;"></i>
                                <span>Gestión de Remisiones</span>
                            </div>
                            <div>
                                <button class="btn btn-danger btn-sm me-2" onclick="openDeleteRemisionesModal()">
                                    ELIMINAR
                                </button>
                                <button class="btn btn-success btn-sm me-2" onclick="exportRemisionesToExcel()">
                                    EXPORTAR
                                </button>
                                <button class="btn btn-primary btn-sm" onclick="generateRemisionFromService()">
                                    GENERAR REMISIÓN
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-3">
                                    <label for="filter-remision-date-from" class="form-label fw-bold">FECHA DESDE:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control date-picker-input" id="filter-remision-date-from" placeholder="dd/mm/aaaa" onchange="filterRemisiones()">
                                        <span class="input-group-text date-picker-icon" style="cursor: pointer;"><i class="bi bi-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="filter-remision-date-to" class="form-label fw-bold">FECHA HASTA:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control date-picker-input" id="filter-remision-date-to" placeholder="dd/mm/aaaa" onchange="filterRemisiones()">
                                        <span class="input-group-text date-picker-icon" style="cursor: pointer;"><i class="bi bi-calendar"></i></span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="search-remisiones" class="form-label fw-bold">BUSCAR:</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="search-remisiones" onkeyup="filterRemisiones()" placeholder="Buscar por ID, código servicio, cliente">
                                        <button class="btn btn-outline-secondary" type="button" onclick="clearRemisionesFilters()" title="Limpiar filtros">
                                            <i class="bi bi-x"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th style="width: 50px; text-align: center; background-color: #1e40af;">
                                                <div style="width: 30px; height: 30px; background-color: #1e40af; display: flex; align-items: center; justify-content: center; border-radius: 4px; margin: 0 auto;">
                                                    <span style="color: #ffffff; font-weight: bold; font-size: 1rem; display: block; line-height: 1;">#</span>
                                                </div>
                                            </th>
                                            <th>ID<br>REMISIÓN</th>
                                            <th>FECHA DE REMISIÓN</th>
                                            <th>HORA DE REMISIÓN</th>
                                            <th>ID<br>SERVICIO</th>
                                            <th>FECHA DE SERVICIO</th>
                                            <th>CÓDIGO<br>SERVICIO</th>
                                            <th>CLIENTE</th>
                                            <th>TÉCNICO</th>
                                            <th>PRECIO</th>
                                            <th style="width: 100px; text-align: center;">ACCIONES</th>
                                        </tr>
                                    </thead>
                                    <tbody id="remisiones-list">
                                        </tbody>
                                </table>
                            </div>
                            
                            <!-- Vista móvil de tarjetas para remisiones -->
                            <div class="mobile-services-view" id="remisiones-cards">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="assign" role="tabpanel" aria-labelledby="assign-tab">
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-person-check me-2" style="font-size: 1.2rem;"></i>
                                <span>Asignar Servicios a Técnicos</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="assign-service-id" class="form-label">Seleccionar Servicio</label>
                                <select class="form-select" id="assign-service-id">
                                    </select>
                            </div>
                            <div class="mb-3">
                                <label for="assign-technician" class="form-label">Seleccionar Técnico</label>
                                <select class="form-select" id="assign-technician">
                                    </select>
                            </div>
                            <button type="button" class="btn btn-primary" onclick="assignServiceToTechnician()">Asignar Servicio</button>
                            <p id="assign-message" class="mt-3"></p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header" style="background-color: #1e40af; color: white;">
                            Servicios Asignados
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>ID</th>
                                            <th>FECHA</th>
                                            <th>HORA</th>
                                            <th>CLIENTE</th>
                                            <th>NIT/CC</th>
                                            <th>UBICACIÓN</th>
                                            <th>CÓDIGO SERVICIO</th>
                                            <th>TÉCNICO</th>
                                            <th>ESTADO</th>
                                            <th>ACCIONES</th>
                                        </tr>
                                    </thead>
                                    <tbody id="assigned-services-list">
                                        </tbody>
                                </table>
                            </div>
                            
                            <!-- Vista móvil de tarjetas para servicios asignados admin -->
                            <div class="mobile-services-view" id="assigned-services-list-cards">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="reports" role="tabpanel" aria-labelledby="reports-tab">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-exclamation-triangle-fill me-2" style="font-size: 1.2rem;"></i>
                                <span>Reportes y Novedades</span>
                            </div>
                        </div>
                        <div class="card-body" id="reports-list">
                            </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="admin-notifications" role="tabpanel" aria-labelledby="admin-notifications-tab-button">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-bell-fill me-2" style="font-size: 1.2rem;"></i>
                                <span>Notificaciones de Administrador</span>
                            </div>
                        </div>
                        <div class="card-body" id="admin-notifications-list">
                            </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="employee-dashboard-section" class="d-none">
            <h2 class="mb-4">Técnico</h2>

            <ul class="nav nav-tabs" id="employeeTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="employee-services-tab" data-bs-toggle="tab" data-bs-target="#employee-services" type="button" role="tab" aria-controls="employee-services" aria-selected="true">Servicios Asignados</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="employee-notifications-tab-button" data-bs-toggle="tab" data-bs-target="#employee-notifications" type="button" role="tab" aria-controls="employee-notifications" aria-selected="false">
                        <span id="employee-notifications-tab">Notificaciones</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="employee-report-replies-tab-button" data-bs-toggle="tab" data-bs-target="#employee-report-replies" type="button" role="tab" aria-controls="employee-report-replies" aria-selected="false">
                        <span id="employee-report-replies-tab">Respuestas de Reportes</span>
                    </button>
                </li>
            </ul>

            <div class="tab-content mt-3" id="employeeTabsContent">
                <div class="tab-pane fade show active" id="employee-services" role="tabpanel" aria-labelledby="employee-services-tab">
                    <div class="card">
                        <div class="card-header d-flex align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-list-ul me-2" style="font-size: 1.2rem;"></i>
                                <span>Servicios Asignados</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Filtros de estado -->
                            <div class="employee-filters">
                                <h6 class="mb-3 d-flex align-items-center">
                                    <i class="bi bi-funnel-fill me-2" style="color: black;"></i>
                                    Filtrar por estado:
                                </h6>
                                <div class="btn-group employee-filter-buttons" role="group">
                                    <button type="button" class="btn btn-filter active" onclick="filterEmployeeServices('todos')">
                                        <i class="bi bi-folder-fill me-1"></i>
                                        TODOS
                                        <span class="badge badge-grey ms-1" id="filter-count-todos">0</span>
                                    </button>
                                    <button type="button" class="btn btn-filter" onclick="filterEmployeeServices('Pendiente')">
                                        <i class="bi bi-clock-fill me-1"></i>
                                        PENDIENTES
                                        <span class="badge badge-orange ms-1" id="filter-count-pendiente">0</span>
                                    </button>
                                    <button type="button" class="btn btn-filter" onclick="filterEmployeeServices('En proceso')">
                                        <i class="bi bi-play-fill me-1"></i>
                                        EN PROCESO
                                        <span class="badge badge-blue ms-1" id="filter-count-en-proceso">0</span>
                                    </button>
                                    <button type="button" class="btn btn-filter" onclick="filterEmployeeServices('Finalizado')">
                                        <i class="bi bi-check-circle-fill me-1"></i>
                                        FINALIZADOS
                                        <span class="badge badge-green ms-1" id="filter-count-finalizado">0</span>
                                    </button>
                                    <button type="button" class="btn btn-filter" onclick="filterEmployeeServices('Cancelado')">
                                        <i class="bi bi-x-circle-fill me-1"></i>
                                        CANCELADOS
                                        <span class="badge badge-red ms-1" id="filter-count-cancelado">0</span>
                                    </button>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>ID</th>
                                            <th>FECHA</th>
                                            <th>HORA</th>
                                            <th>CLIENTE</th>
                                            <th>NIT/CC</th>
                                            <th>UBICACIÓN</th>
                                            <th>CÓDIGO SERVICIO</th>
                                            <th>ESTADO</th>
                                            <th>ACCIONES</th>
                                        </tr>
                                    </thead>
                                    <tbody id="employee-assigned-services-list">
                                        </tbody>
                                </table>
                            </div>
                            
                            <!-- Vista móvil de tarjetas -->
                            <div class="mobile-services-view" id="employee-assigned-services-cards">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="employee-notifications" role="tabpanel" aria-labelledby="employee-notifications-tab-button">
                    <div class="card">
                        <div class="card-header d-flex align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-bell me-2" style="font-size: 1.2rem;"></i>
                                <span>Mis Notificaciones</span>
                            </div>
                        </div>
                        <div class="card-body" id="employee-notifications-list">
                            </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="employee-report-replies" role="tabpanel" aria-labelledby="employee-report-replies-tab-button">
                    <div class="card">
                        <div class="card-header d-flex align-items-center" style="background-color: #1e40af; color: white;">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-chat-dots me-2" style="font-size: 1.2rem;"></i>
                                <span>Respuestas a Mis Reportes</span>
                            </div>
                        </div>
                        <div class="card-body" id="employee-report-replies-list">
                            </div>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- Modal para crear/editar usuario -->
    <div class="modal fade" id="createUserModal" tabindex="-1" aria-labelledby="createUserModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="createUserModalLabel">Crear/Editar Usuario</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="user-form">
                        <input type="hidden" id="edit-user-id">
                        <div class="mb-3">
                            <label for="user-username" class="form-label">Nombre de Usuario</label>
                            <input type="text" class="form-control" id="user-username" required>
                        </div>
                        <div class="mb-3">
                            <label for="user-password" class="form-label">Contraseña</label>
                            <input type="password" class="form-control" id="user-password" autocomplete="new-password" placeholder="Dejar vacío para mantener la contraseña actual (solo al editar)">
                            <div class="form-text">
                                La contraseña debe tener mínimo 8 caracteres, incluir 1 mayúscula, 1 minúscula y 1 número.
                            </div>
                            <div id="password-error" class="text-danger small mt-1" style="display: none;"></div>
                        </div>
                        <div class="mb-3">
                            <label for="user-role" class="form-label">Rol</label>
                            <select class="form-select" id="user-role" required>
                                <option value="employee">Técnico</option>
                                <option value="admin">Administrador</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar Usuario</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para eliminar usuarios masivamente -->
    <div class="modal fade" id="deleteUsersModal" tabindex="-1" aria-labelledby="deleteUsersModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title" id="deleteUsersModalLabel">Eliminar Usuarios</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-3">Selecciona los registros a eliminar:</p>
                    <div class="mb-3">
                        <label for="search-delete-users" class="form-label fw-bold">BUSCAR:</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="search-delete-users" onkeyup="filterDeleteUsers()" placeholder="Buscar por ID, usuario o rol...">
                            <button class="btn btn-outline-secondary" type="button" onclick="clearDeleteUsersSearch()" title="Limpiar búsqueda">
                                <i class="bi bi-x-circle"></i>
                            </button>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-3">
                        <button type="button" class="btn btn-link text-primary p-0 me-3" onclick="selectAllUsers()" style="text-decoration: none;">SELECCIONAR TODOS</button>
                        <button type="button" class="btn btn-link text-secondary p-0" onclick="deselectAllUsers()" style="text-decoration: none;">DESELECCIONAR TODOS</button>
                    </div>
                    <div id="delete-users-list" style="max-height: 400px; overflow-y: auto;">
                        <!-- Los usuarios se cargarán aquí dinámicamente -->
                    </div>
                    <div class="alert alert-warning mt-3 mb-0" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <strong>Advertencia:</strong> Esta acción no se puede deshacer. Los registros seleccionados serán eliminados permanentemente.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" onclick="confirmDeleteUsers()">Eliminar Seleccionados</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para crear/editar cliente -->
    <div class="modal fade" id="createClientModal" tabindex="-1" aria-labelledby="createClientModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="createClientModalLabel">Crear/Editar Cliente</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="client-form">
                        <input type="hidden" id="edit-client-id">
                        <div class="mb-3">
                            <label for="client-name" class="form-label">NOMBRE</label>
                            <input type="text" class="form-control" id="client-name" required oninput="updateClientConsecutive()">
                        </div>
                        <div class="mb-3">
                            <label for="client-nit" class="form-label">NIT/CC</label>
                            <input type="text" class="form-control" id="client-nit" required>
                        </div>
                        <div class="mb-3">
                            <label for="client-address" class="form-label">DIRECCIÓN</label>
                            <input type="text" class="form-control" id="client-address" required>
                        </div>
                        <div class="mb-3">
                            <label for="client-phone" class="form-label">TELÉFONO</label>
                            <input type="text" class="form-control" id="client-phone" required>
                        </div>
                        <div class="mb-3">
                            <label for="client-email" class="form-label">EMAIL</label>
                            <input type="email" class="form-control" id="client-email" required>
                        </div>
                        <div class="mb-3">
                            <label for="client-consecutive" class="form-label">CONSECUTIVO</label>
                            <input type="text" class="form-control" id="client-consecutive" readonly>
                            <div class="form-text">Se genera automáticamente con las 4 primeras letras del nombre</div>
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar Cliente</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para eliminar clientes masivamente -->
    <div class="modal fade" id="deleteClientsModal" tabindex="-1" aria-labelledby="deleteClientsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title" id="deleteClientsModalLabel">Eliminar Clientes</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-3">Selecciona los registros a eliminar:</p>
                    <div class="mb-3">
                        <label for="search-delete-clients" class="form-label fw-bold">BUSCAR:</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="search-delete-clients" onkeyup="filterDeleteClients()" placeholder="Buscar por nombre, NIT/CC, dirección, teléfono o email...">
                            <button class="btn btn-outline-secondary" type="button" onclick="clearDeleteClientsSearch()" title="Limpiar búsqueda">
                                <i class="bi bi-x-circle"></i>
                            </button>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-3">
                        <button type="button" class="btn btn-link text-primary p-0 me-3" onclick="selectAllClients()" style="text-decoration: none;">SELECCIONAR TODOS</button>
                        <button type="button" class="btn btn-link text-secondary p-0" onclick="deselectAllClients()" style="text-decoration: none;">DESELECCIONAR TODOS</button>
                    </div>
                    <div id="delete-clients-list" style="max-height: 400px; overflow-y: auto;">
                        <!-- Los clientes se cargarán aquí dinámicamente -->
                    </div>
                    <div class="alert alert-warning mt-3 mb-0" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <strong>Advertencia:</strong> Esta acción no se puede deshacer. Los registros seleccionados serán eliminados permanentemente.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" onclick="confirmDeleteClients()">Eliminar Seleccionados</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Input oculto para importar archivos de clientes -->
    <input type="file" id="import-clients-file" accept=".xlsx,.xls" style="display: none;">

    <!-- Modal para eliminar servicios masivamente -->
    <div class="modal fade" id="deleteServicesModal" tabindex="-1" aria-labelledby="deleteServicesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title" id="deleteServicesModalLabel">Eliminar Servicios</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-3">Selecciona los registros a eliminar:</p>
                    <div class="mb-3">
                        <label for="search-delete-services" class="form-label fw-bold">BUSCAR:</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="search-delete-services" onkeyup="filterDeleteServices()" placeholder="Buscar por ID, cliente, ubicación o código de servicio...">
                            <button class="btn btn-outline-secondary" type="button" onclick="clearDeleteServicesSearch()" title="Limpiar búsqueda">
                                <i class="bi bi-x-circle"></i>
                            </button>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-3">
                        <button type="button" class="btn btn-link text-primary p-0 me-3" onclick="selectAllServices()" style="text-decoration: none;">SELECCIONAR TODOS</button>
                        <button type="button" class="btn btn-link text-secondary p-0" onclick="deselectAllServices()" style="text-decoration: none;">DESELECCIONAR TODOS</button>
                    </div>
                    <div id="delete-services-list" style="max-height: 400px; overflow-y: auto;">
                        <!-- Los servicios se cargarán aquí dinámicamente -->
                    </div>
                    <div class="alert alert-warning mt-3 mb-0" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <strong>Advertencia:</strong> Esta acción no se puede deshacer. Los registros seleccionados serán eliminados permanentemente.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" onclick="confirmDeleteServices()">Eliminar Seleccionados</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para eliminar costos de servicios masivamente -->
    <div class="modal fade" id="deleteCostoServiciosModal" tabindex="-1" aria-labelledby="deleteCostoServiciosModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title" id="deleteCostoServiciosModalLabel">Eliminar Costos de Servicios</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-3">Selecciona los registros a eliminar:</p>
                    <div class="mb-3">
                        <label for="search-delete-costo-servicios" class="form-label fw-bold">BUSCAR:</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="search-delete-costo-servicios" onkeyup="filterDeleteCostoServicios()" placeholder="Buscar por código, tipo o descripción...">
                            <button class="btn btn-outline-secondary" type="button" onclick="clearDeleteCostoServiciosSearch()" title="Limpiar búsqueda">
                                <i class="bi bi-x-circle"></i>
                            </button>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-3">
                        <button type="button" class="btn btn-link text-primary p-0 me-3" onclick="selectAllCostoServicios()" style="text-decoration: none;">SELECCIONAR TODOS</button>
                        <button type="button" class="btn btn-link text-secondary p-0" onclick="deselectAllCostoServicios()" style="text-decoration: none;">DESELECCIONAR TODOS</button>
                    </div>
                    <div id="delete-costo-servicios-list" style="max-height: 400px; overflow-y: auto;">
                        <!-- Los costos de servicios se cargarán aquí dinámicamente -->
                    </div>
                    <div class="alert alert-warning mt-3 mb-0" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <strong>Advertencia:</strong> Esta acción no se puede deshacer. Los registros seleccionados serán eliminados permanentemente.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" onclick="confirmDeleteCostoServicios()">Eliminar Seleccionados</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para eliminar remisiones masivamente -->
    <div class="modal fade" id="deleteRemisionesModal" tabindex="-1" aria-labelledby="deleteRemisionesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title" id="deleteRemisionesModalLabel">Eliminar Remisiones</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="mb-3">Selecciona los registros a eliminar:</p>
                    <div class="mb-3">
                        <label for="search-delete-remisiones" class="form-label fw-bold">BUSCAR:</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="search-delete-remisiones" onkeyup="filterDeleteRemisiones()" placeholder="Buscar por ID servicio, cliente, fecha o código...">
                            <button class="btn btn-outline-secondary" type="button" onclick="clearDeleteRemisionesSearch()" title="Limpiar búsqueda">
                                <i class="bi bi-x-circle"></i>
                            </button>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end mb-3">
                        <button type="button" class="btn btn-link text-primary p-0 me-3" onclick="selectAllRemisiones()" style="text-decoration: none;">SELECCIONAR TODOS</button>
                        <button type="button" class="btn btn-link text-secondary p-0" onclick="deselectAllRemisiones()" style="text-decoration: none;">DESELECCIONAR TODOS</button>
                    </div>
                    <div id="delete-remisiones-list" style="max-height: 400px; overflow-y: auto;">
                        <!-- Las remisiones se cargarán aquí dinámicamente -->
                    </div>
                    <div class="alert alert-warning mt-3 mb-0" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <strong>Advertencia:</strong> Esta acción no se puede deshacer. Los registros seleccionados serán eliminados permanentemente.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" onclick="confirmDeleteRemisiones()">Eliminar Seleccionados</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para crear/editar costo de servicio -->
    <div class="modal fade" id="createCostoServicioModal" tabindex="-1" aria-labelledby="createCostoServicioModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="createCostoServicioModalLabel">Crear/Editar Servicio</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="costo-servicio-form">
                        <input type="hidden" id="edit-costo-servicio-id">
                        <div class="mb-3">
                            <label for="costo-servicio-codigo" class="form-label">Código de Servicio</label>
                            <input type="text" class="form-control" id="costo-servicio-codigo" required placeholder="Ingresa el código de servicio">
                        </div>
                        <div class="mb-3">
                            <label for="costo-servicio-tipo" class="form-label">Tipo de Servicio</label>
                            <input type="text" class="form-control" id="costo-servicio-tipo" required placeholder="Ingresa el tipo de servicio">
                        </div>
                        <div class="mb-3">
                            <label for="costo-servicio-descripcion" class="form-label">Descripción</label>
                            <textarea class="form-control" id="costo-servicio-descripcion" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="costo-servicio-precio" class="form-label">Precio</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="costo-servicio-precio" min="0" step="0.01" required>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Guardar Servicio</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para registrar servicio -->
    <div class="modal fade" id="registerServiceModal" tabindex="-1" aria-labelledby="registerServiceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="registerServiceModalLabel">Registrar Servicio</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="service-form">
                        <input type="hidden" id="edit-service-id">
                        
                        <!-- Sección de detalles del servicio -->
                        <!-- Primera fila: FECHA, HORA DE SERVICIO, CÓDIGO DE SERVICIO -->
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="service-date" class="form-label fw-bold">FECHA</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="service-date" placeholder="dd/mm/aaaa" required>
                                    <span class="input-group-text date-picker-icon" style="cursor: pointer;">
                                        <i class="bi bi-calendar"></i>
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="service-time" class="form-label fw-bold">HORA DE SERVICIO</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="service-time" placeholder="--:-- ----">
                                    <span class="input-group-text time-picker-icon" style="cursor: pointer;">
                                        <i class="bi bi-clock"></i>
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3">
                                <div class="service-code-selector">
                                    <label for="service-code" class="form-label fw-bold service-code-label">CÓDIGO DE SERVICIO</label>
                                    <input type="text" class="form-control service-code-input" id="service-code" placeholder="Escribir para buscar código..." required onchange="loadServiceDetails()">
                                    <div id="service-code-suggestions" class="service-code-suggestions" style="display: none;"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Segunda fila: TIPO DE SERVICIO, DESCRIPCIÓN (más grande), CANTIDAD (más pequeño) -->
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="service-type" class="form-label fw-bold">TIPO DE SERVICIO</label>
                                <input type="text" class="form-control" id="service-type" readonly>
                            </div>
                            <div class="col-md-5 mb-3">
                                <label for="service-description" class="form-label fw-bold">DESCRIPCIÓN</label>
                                <input type="text" class="form-control" id="service-description" readonly>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label for="service-quantity" class="form-label fw-bold">CANTIDAD</label>
                                <input type="number" class="form-control" id="service-quantity" min="1" value="1">
                            </div>
                        </div>
                        
                        <!-- Sección de servicios adicionales -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">SERVICIOS ADICIONALES</label>
                            <div id="additional-services-container"></div>
                            <button type="button" class="btn btn-primary btn-sm mt-2" onclick="addAdditionalService()">
                                <i class="bi bi-plus-circle me-1"></i> AGREGAR SERVICIO ADICIONAL
                            </button>
                        </div>
                        
                        <!-- Sección de información del cliente -->
                        <hr class="my-4">
                        <div class="mb-3">
                            <label for="service-client-name" class="form-label fw-bold">NOMBRE CLIENTE</label>
                            <input type="text" class="form-control" id="service-client-name" required onblur="loadClientData()">
                            <div id="client-name-suggestions" class="list-group mt-2" style="display: none; max-height: 200px; overflow-y: auto;"></div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="service-client-nit" class="form-label fw-bold">NIT O CC</label>
                            <input type="text" class="form-control" id="service-client-nit" placeholder="Ej: 12345678-9 o 1234567890">
                        </div>
                        
                        <div class="mb-3">
                            <label for="service-location" class="form-label fw-bold">UBICACIÓN (DIRECCIÓN CLIENTE)</label>
                            <input type="text" class="form-control" id="service-location" placeholder="Ej: Calle 123 #4-56, Barrio" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="service-client-phone" class="form-label fw-bold">TELÉFONO</label>
                            <input type="text" class="form-control" id="service-client-phone">
                        </div>
                        
                        <div class="mb-3">
                            <label for="service-client-email" class="form-label fw-bold">EMAIL</label>
                            <input type="email" class="form-control" id="service-client-email" placeholder="ejemplo@correo.com">
                        </div>
                        
                        <div class="mb-3">
                            <label for="service-status" class="form-label fw-bold">ESTADO</label>
                            <select class="form-select" id="service-status" required>
                                <option value="Pendiente">Pendiente</option>
                                <option value="En proceso">En proceso</option>
                                <option value="Finalizado">Finalizado</option>
                                <option value="Cancelado">Cancelado</option>
                            </select>
                        </div>

                        <!-- Secciones dinámicas que se muestran según el estado -->
                        <div class="mb-3 d-none" id="photo-evidence-section">
                            <label for="service-photo" class="form-label fw-bold">FOTO DE EVIDENCIA (JPG, PNG)</label>
                            <input type="file" class="form-control" id="service-photo" accept="image/jpeg, image/png" capture="camera">
                            <img id="service-photo-preview" class="service-photo-evidence mt-2 d-none" style="max-height: 200px;" alt="Previsualización de Foto">
                        </div>

                        <div class="mb-3 d-none" id="client-signature-section">
                            <label class="form-label fw-bold">FIRMA DEL CLIENTE</label>
                            <div class="signature-pad-container border">
                                <canvas id="signature-pad-client" class="signature-pad" width="400" height="200"></canvas>
                            </div>
                            <button type="button" class="btn btn-outline-secondary btn-sm mt-2" onclick="clearSignaturePad('client')">Borrar Firma Cliente</button>
                        </div>

                        <div class="mb-3 d-none" id="technician-signature-section">
                            <label class="form-label fw-bold">FIRMA DEL TÉCNICO</label>
                            <div class="signature-pad-container border">
                                <canvas id="signature-pad-technician" class="signature-pad" width="400" height="200"></canvas>
                            </div>
                            <button type="button" class="btn btn-outline-secondary btn-sm mt-2" onclick="clearSignaturePad('technician')">Borrar Firma Técnico</button>
                        </div>

                        <div class="mt-4">
                            <button type="submit" class="btn btn-primary fw-bold" style="background-color: #1e40af;">GUARDAR SERVICIO</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para generar remisión -->
    <div class="modal fade" id="generateRemisionModal" tabindex="-1" aria-labelledby="generateRemisionModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="generateRemisionModalLabel">Generar Remisión</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="generate-remision-form">
                        <div class="mb-3">
                            <label for="remision-service-search" class="form-label">Buscar Servicio</label>
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="fas fa-search"></i>
                                </span>
                                <input type="text" class="form-control" id="remision-service-search" placeholder="Buscar por ID, cliente, descripción..." autocomplete="off">
                                <button class="btn btn-outline-secondary" type="button" id="clear-remision-search" title="Limpiar búsqueda">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="form-text" id="remision-search-results">
                                <span class="text-muted">Escribe para buscar servicios finalizados</span>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="remision-service-id" class="form-label">Seleccionar Servicio</label>
                            <select class="form-select" id="remision-service-id" required>
                                <option value="">Seleccionar servicio...</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Generar Remisión</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para ver detalles de servicio -->
    <div class="modal fade" id="viewServiceModal" tabindex="-1" aria-labelledby="viewServiceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="viewServiceModalLabel">Detalles del Servicio</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="view-service-details">
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para reportar novedad -->
    <div class="modal fade" id="reportNoveltyModal" tabindex="-1" aria-labelledby="reportNoveltyModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="reportNoveltyModalLabel">Reportar Novedad/Problema</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="novelty-form">
                        <div class="mb-3">
                            <label for="novelty-service-id" class="form-label">ID del Servicio (opcional)</label>
                            <input type="text" class="form-control" id="novelty-service-id">
                        </div>
                        <div class="mb-3">
                            <label for="novelty-description" class="form-label">Descripción de la Novedad</label>
                            <textarea class="form-control" id="novelty-description" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-danger">Enviar Reporte</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para responder reporte -->
    <div class="modal fade" id="replyReportModal" tabindex="-1" aria-labelledby="replyReportModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="replyReportModalLabel">Responder Reporte</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="reply-report-form">
                        <input type="hidden" id="reply-report-id">
                        <div class="mb-3">
                            <label for="reply-report-message" class="form-label">Mensaje de Respuesta</label>
                            <textarea class="form-control" id="reply-report-message" rows="3" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Enviar Respuesta</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para alerta personalizada -->
    <div class="modal fade" id="customAlertModal" tabindex="-1" aria-labelledby="customAlertModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="customAlertModalLabel">Alerta</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="customAlertModalBody">
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Aceptar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para confirmación personalizada -->
    <div class="modal fade" id="customConfirmModal" tabindex="-1" aria-labelledby="customConfirmModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="customConfirmModalLabel">Confirmación</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="customConfirmModalBody">
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="customConfirmBtn">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para motivo de cancelación -->
    <div class="modal fade" id="cancelReasonModal" tabindex="-1" aria-labelledby="cancelReasonModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <h5 class="modal-title fw-bold" id="cancelReasonModalLabel">Motivo de Cancelación</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Por favor, ingresa el motivo por el cual el servicio será cancelado.</p>
                    <div class="mb-3">
                        <label for="cancel-reason-input" class="form-label">Motivo:</label>
                        <textarea class="form-control" id="cancel-reason-input" rows="3" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-danger" id="confirmCancelReasonBtn">Confirmar Cancelación</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Input oculto para importar archivos -->
    <input type="file" id="import-services-file" accept=".xlsx,.xls" style="display: none;">
    <input type="file" id="import-costo-servicios-file" accept=".xlsx,.xls" style="display: none;">

    <!-- Modal de progreso para importaciones y eliminaciones masivas -->
    <div class="modal fade" id="progressModal" tabindex="-1" aria-labelledby="progressModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1e40af; color: white;">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-arrow-repeat me-2" id="progress-icon" style="font-size: 1.2rem;"></i>
                        <h5 class="modal-title mb-0" id="progress-title">Procesando...</h5>
                    </div>
                    <button type="button" class="btn-close btn-close-white d-none" id="progress-close-btn" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="progress-message" class="mb-3">Iniciando proceso...</div>
                    <div class="progress mb-3" style="height: 30px;">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" id="progress-bar" style="width: 0%; background-color: #1e40af;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                            <span id="progress-percentage">0%</span>
                        </div>
                    </div>
                    <div class="row g-3">
                        <div class="col-4">
                            <div class="card text-center" style="background-color: #d1f2eb; border-color: #1abc9c;">
                                <div class="card-body p-3">
                                    <div class="fw-bold" style="font-size: 1.5rem; color: #16a085;" id="progress-successes">0</div>
                                    <div class="text-muted small">Éxitos</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="card text-center" style="background-color: #fef9e7; border-color: #f39c12;">
                                <div class="card-body p-3">
                                    <div class="fw-bold" style="font-size: 1.5rem; color: #e67e22;" id="progress-warnings">0</div>
                                    <div class="text-muted small">Advertencias</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="card text-center" style="background-color: #fadbd8; border-color: #e74c3c;">
                                <div class="card-body p-3">
                                    <div class="fw-bold" style="font-size: 1.5rem; color: #c0392b;" id="progress-errors">0</div>
                                    <div class="text-muted small">Errores</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="progress-done-btn" data-bs-dismiss="modal" style="display: none;">HECHO</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Botón Scroll to Top -->
    <button id="scroll-to-top" class="scroll-to-top-btn" title="Ir arriba">
        <i class="bi bi-arrow-up"></i>
    </button>

    <!-- Footer -->
    <footer class="nextgen-footer">
        <div class="footer-content">
            Desarrollado por <a href="https://jhonvega270523.github.io/NextGen-Digital/" target="_blank" rel="noopener noreferrer" class="footer-link-bold">NextGen Digital</a> - <a href="mailto:nextgendigital26@gmail.com" class="footer-link">nextgendigital26@gmail.com</a>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/signature_pad@4.1.0/dist/signature_pad.umd.min.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="js/geolocation-utils.js"></script>
    <script src="js/script.js"></script>
</body>
</html>