# Configuración de seguridad para CONSEGUR
# Desactiva el listado de directorios y protege carpetas
Options -Indexes -MultiViews

# Proteger todas las carpetas por defecto
<DirectoryMatch "^/.*">
    Order allow,deny
    Deny from all
</DirectoryMatch>

# Permitir acceso solo a archivos específicos en la raíz
<FilesMatch "^(index\.html|.*\.css|.*\.js|.*\.png|.*\.jpg|.*\.jpeg|.*\.gif|.*\.ico)$">
    Order allow,deny
    Allow from all
</FilesMatch>

# Proteger archivos sensibles
<Files "*.htaccess">
    Order allow,deny
    Deny from all
</Files>

<Files "*.log">
    Order allow,deny
    Deny from all
</Files>

# Proteger archivos de configuración
<Files "*.ini">
    Order allow,deny
    Deny from all
</Files>

<Files "*.conf">
    Order allow,deny
    Deny from all
</Files>

# Proteger archivos de base de datos
<Files "*.db">
    Order allow,deny
    Deny from all
</Files>

<Files "*.sqlite">
    Order allow,deny
    Deny from all
</Files>

# Proteger archivos de backup
<Files "*.bak">
    Order allow,deny
    Deny from all
</Files>

<Files "*.backup">
    Order allow,deny
    Deny from all
</Files>

# Configuración de seguridad adicional
# Prevenir acceso a archivos ocultos
<Files ".*">
    Order allow,deny
    Deny from all
</Files>

# Proteger carpetas específicas del proyecto
<Directory "assets">
    Order allow,deny
    Deny from all
</Directory>

<Directory "css">
    Order allow,deny
    Deny from all
</Directory>

<Directory "js">
    Order allow,deny
    Deny from all
</Directory>

<Directory "docs">
    Order allow,deny
    Deny from all
</Directory>

# Permitir acceso solo a archivos específicos en la raíz
<Files "index.html">
    Order allow,deny
    Allow from all
</Files>

# Permitir acceso a archivos de recursos solo desde index.html
<Files "*.css">
    Order allow,deny
    Allow from all
</Files>

<Files "*.js">
    Order allow,deny
    Allow from all
</Files>

<Files "*.png">
    Order allow,deny
    Allow from all
</Files>

<Files "*.jpg">
    Order allow,deny
    Allow from all
</Files>

<Files "*.jpeg">
    Order allow,deny
    Allow from all
</Files>

<Files "*.gif">
    Order allow,deny
    Allow from all
</Files>

<Files "*.ico">
    Order allow,deny
    Allow from all
</Files>

# Configuración de compresión para mejorar rendimiento
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Configuración de caché para archivos estáticos
<IfModule mod_expires.c>
    ExpiresActive on
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/ico "access plus 1 month"
</IfModule>

# Bloquear acceso directo a archivos PHP si los hubiera
<Files "*.php">
    Order allow,deny
    Deny from all
</Files>

# Bloquear acceso a archivos de configuración del servidor
<Files ".htaccess">
    Order allow,deny
    Deny from all
</Files>

<Files ".htpasswd">
    Order allow,deny
    Deny from all
</Files>

# Configuración de páginas de error personalizadas
ErrorDocument 403 "Acceso denegado. No tienes permisos para acceder a este recurso."
ErrorDocument 404 "Página no encontrada. El recurso solicitado no existe."
ErrorDocument 500 "Error interno del servidor. Por favor, intente más tarde."

# Prevenir acceso a archivos de desarrollo
<FilesMatch "\.(git|svn|hg|bzr|cvs)">
    Order allow,deny
    Deny from all
</FilesMatch>

# Prevenir acceso a archivos de IDE
<FilesMatch "\.(vscode|idea|sublime-project|sublime-workspace)">
    Order allow,deny
    Deny from all
</FilesMatch>
